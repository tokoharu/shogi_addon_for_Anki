# Shogi Visualizer for Anki

This is an addon for Anki (mainly 2.1.x).

You can use following command to view board when you open question card.

`[sfen] (sfen format) [/sfen]`

`[kif]  (kif format) [/kif]` 



(以下日本語)

フリーソフトAnkiを用いて将棋の実力向上を手助けするアドオンです。

将棋倶楽部24、将棋ウォーズ、将棋クエスト等での実戦の振り返りを将棋所を用いて行った際、将棋エンジンの指摘によって課題局面が見つかることがあります。
Ankiとこのアドオンを組み合わせることで、この課題局面の復習効率を高めることができます。


![Alt text](./images/anki1.png "問題画面")
![Alt text](./images/anki2.png "問題＋解答画面")


### Ankiについての補足

* Ankiとは

Ankiは単語帳を電子化したようなものです。カードの表面に問題を書き、裏面に答えを書いておき、さらに複数枚のカードを用意すれば、Ankiが適切なタイミングで出題をしてくれます。参考 :  http://rs.luminousspice.com/how-to-anki/

* Anki + 局面画像保存による管理の難点

単にAnkiのデフォルト機能を用いることで、課題局面を保存することも可能です。
ただしその場合、将来的にもう一度将棋所で他の将棋エンジンを用いる際にもう一度局面を入力する必要があり、手間がかかります。

そこで、本アドオンでは局面の入力としてKIFフォーマット、sfenフォーマットに対応し、Anki上で可視化しています。
これによって、後から課題局面を将棋エンジンで検討したい場合にはコピーとペーストのみでその局面を再現することが可能になります。


## アドオンの導入方法

(Anki 2.1.xの場合)
1. Ankiをインストールし、起動する
2. [ツール] → [アドオン] → [ファイルを見る]
3. ここにこのレポジトリのAnki2.1ディレクトリ以下にある shogi_visualizationディレクトリ を保存する。
4. Ankiを再起動する
5. [ツール] → [アドオン] にshogi_visualization があればOK.

(Anki 2.0.xの場合(非推奨))
1. Ankiをインストールし、起動する
2. [ツール] → [アドオン] → [アドオンフォルダを開く]
3. ここにこのレポジトリのAnki2.0ディレクトリ以下にある shogi_visualization.py を保存する。
4. Ankiを再起動する
5. [ツール] → [アドオン] にshogi_visualization があればOK.




## Ankiにおけるこのアドオンの使用方法
kif形式の局面を用いる場合、Ankiの編集画面で、このkif形式の局面情報を
[kif]　と [/kif]
でくくります。

次が記入例になります。
 
[kif]
後手の持駒：飛二　角二　金二　銀四　桂四　香四　歩十八  
  ９ ８ ７ ６ ５ ４ ３ ２ １  
+---------------------------+  
| ・ ・ ・ ・v玉 ・ ・ ・ ・|一  
| ・ ・ ・ ・ ・ ・ ・ ・ ・|二  
| ・ ・ ・ ・ 金 ・ ・ ・ ・|三  
| ・ ・ ・ ・ ・ ・ ・ ・ ・|四  
| ・ ・ ・ ・ ・ ・ ・ ・ ・|五  
| ・ ・ ・ ・ ・ ・ ・ ・ ・|六  
| ・ ・ ・ ・ ・ ・ ・ ・ ・|七  
| ・ ・ ・ ・ ・ ・ ・ ・ ・|八  
| ・ ・ ・ ・ ・ ・ ・ ・ ・|九  
+---------------------------+  
先手の持駒：金  
先手：  
後手：  
[/kif]  

sfen形式であれば次のようになります。

[sfen]lnsgkgsnl/1r5b1/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL w - 1[/sfen]



## 将棋所の活用方法
次が作者が便利だと思った使い方になります。

1. 将棋所をダウンロードし、思考エンジンも好きなものを導入します。
2. 将棋ウォーズなどから自己対局の棋譜を取得します
3. 将棋所で棋譜解析をかけます
4. 良くなかった手と、どう考えれば良かったかを分析します
5. [編集] -> [局面コピー(KIF/KI2形式)]を選択します
6. Anki側で[追加]を選択します。
7. 表面に先ほどコピーした局面を貼り付け、前後に[kif], [/kif]を書きます。
8. 裏面に考察した内容を書きます

以上の手順で追加を行うことで、自分が間違えやすいであろう問題を追加することができます。

また、一度追加した問題に対してもう一度解析したくなった場合でも、次の手順で将棋所での解析が可能です。
1. [編集] を押し、kifフォーマットの中身をコピー
2. 将棋所にペースト


## 将棋倶楽部24、 将棋ウォーズ、将棋クエスト、それぞれからの利用方法

この節では、各種オンライン対局場から棋譜を取得し、将棋所で検討できる方法について記述します。
なお、2020/5/25現在の情報です。

### 将棋ウォーズ
1. 将棋ウォーズにログインする。
1. マイページを開き、[対局結果・棋譜一覧]をボタンを押下する。
1. 解析したい棋譜を選択し、[見る]ボタンを押下する。
1. [ツイート]ボタンを押下し、棋譜のURLをコピーする。
1. 将棋ウォーズ棋譜保存(http://swks.sakura.ne.jp/wars/kifusave/ )へアクセスする。
1. 棋譜URLを張り付け、虫眼鏡のアイコンを押下する。
1. [保存]ボタンを右クリックして、PC内へ保存する。 
1. 保存したファイル内のテキストをコピー、将棋所を開き盤面上をクリックしてCtrl + Vする。


### 将棋倶楽部24
1. 東京棋譜 / 大阪棋譜 アプリケーションを開く。
1. 自分のユーザーでログインする。
1. 対局者、期間などの条件を入力して[検索]ボタンを押下する。
1. 解析したい棋譜を選択し、ダブルクリックする。
1. [棋譜]ボタンを押下する。
1. 棋譜ウインドウ内のテキストをコピーする。
1. 将棋所を開き、盤面上をクリックしてCtrl + Vする。

### 将棋クエスト
1. 将棋クエスト履歴検索β(https://c-loft.com/shogi/quest/ )へアクセスする。
1. 自分のユーザー、対局条件を入力して[検索]ボタンを押下する。
1. 解析したい棋譜を選択し、[clip]を押下する。
1. 棋譜ウインドウ内のテキストをコピーする。
1. 将棋所を開き、盤面上をクリックしてCtrl + Vする。
